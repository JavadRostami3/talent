# ğŸ¯ Unified Research Records API - ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø³ÙˆØ§Ø¨Ù‚ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ

## ğŸ“Š **Ù…Ø´Ú©Ù„ Ù‚Ø¨Ù„ÛŒ:**

Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ù‚Ø¨Ù„ÛŒØŒ Ø³ÙˆØ§Ø¨Ù‚ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ Ø¯Ø± 6 Ù…Ø¯Ù„ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø¨ÙˆØ¯Ù†Ø¯:
- `ResearchArticle` - Ù…Ù‚Ø§Ù„Ø§Øª Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ Ùˆ ØªØ±ÙˆÛŒØ¬ÛŒ
- `Patent` - Ø§Ø®ØªØ±Ø§Ø¹Ø§Øª
- `FestivalAward` - Ø¬ÙˆØ§ÛŒØ² Ø¬Ø´Ù†ÙˆØ§Ø±Ù‡
- `ConferenceArticle` - Ù…Ù‚Ø§Ù„Ø§Øª Ú©Ù†ÙØ±Ø§Ù†Ø³
- `Book` - Ú©ØªØ§Ø¨â€ŒÙ‡Ø§
- `MastersThesis` - Ù¾Ø§ÛŒØ§Ù†â€ŒÙ†Ø§Ù…Ù‡ Ø§Ø±Ø´Ø¯

**Ù…Ø´Ú©Ù„Ø§Øª:**
1. ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯ Ø¨Ø§ÛŒØ¯ 6 Ø¯Ø±Ø®ÙˆØ§Ø³Øª API Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ù…ÛŒâ€ŒÙØ±Ø³ØªØ§Ø¯
2. Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± ÛŒÚ© Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ø­Ø¯ Ø³Ø®Øª Ø¨ÙˆØ¯
3. Ú©Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ Ø¯Ø± ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯
4. Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª state

---

## âœ… **Ø±Ø§Ù‡â€ŒØ­Ù„: Unified API**

### **ÙÙ„Ø³ÙÙ‡ Ø·Ø±Ø§Ø­ÛŒ:**
- **Backend:** Ø³Ø§Ø®ØªØ§Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ ØªÙÚ©ÛŒÚ©â€ŒØ´Ø¯Ù‡ Ø­ÙØ¸ Ø´Ø¯ (Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ØµØ­ÛŒØ­)
- **Frontend:** ÛŒÚ© API ÙˆØ§Ø­Ø¯ Ø¨Ø§ ÙØ±Ù…Øª Ù…Ø´ØªØ±Ú© Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ø³ÙˆØ§Ø¨Ù‚

### **Ù…Ø²Ø§ÛŒØ§:**
- âœ… ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø¬Ø§ÛŒ 6 Ø¯Ø±Ø®ÙˆØ§Ø³Øª
- âœ… ÙØ±Ù…Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´
- âœ… ÙÛŒÙ„ØªØ± Ùˆ Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¢Ø³Ø§Ù†
- âœ… Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± ÛŒÚ© Ø¬Ø¯ÙˆÙ„
- âœ… Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¢Ù…Ø§Ø±

---

## ğŸš€ **API Endpoints Ø¬Ø¯ÛŒØ¯:**

### **1ï¸âƒ£ Ø¯Ø±ÛŒØ§ÙØª ØªÙ…Ø§Ù… Ø³ÙˆØ§Ø¨Ù‚ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ (Unified)**

```http
GET /api/applications/{application_id}/research-records/
Authorization: Bearer {token}
```

**Response:**
```json
{
  "total_records": 10,
  "total_score": 35.5,
  "summary": {
    "articles": 5,
    "patents": 2,
    "awards": 1,
    "conferences": 1,
    "books": 1,
    "thesis": 0
  },
  "records": [
    {
      "id": 1,
      "type": "ARTICLE",
      "article_type": "Ù…Ù‚Ø§Ù„Ù‡ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ Ø¨ÛŒÙ†â€ŒØ§Ù„Ù…Ù„Ù„ÛŒ",
      "title_fa": "Ø¹Ù†ÙˆØ§Ù† ÙØ§Ø±Ø³ÛŒ",
      "title_en": "English Title",
      "journal_name": "Nature",
      "doi": "10.1234/nature.2024",
      "publish_year": 2024,
      "status": "Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡",
      "score": 8,
      "file": "/media/...",
      "reviewed_by": "Ø¯Ú©ØªØ± Ø§Ø­Ù…Ø¯ÛŒ",
      "created_at": "2024-12-01T10:00:00Z"
    },
    {
      "id": 2,
      "type": "PATENT",
      "title_fa": "Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯...",
      "patent_number": "123456",
      "registration_date": "1402/09/15",
      "score": 5,
      "created_at": "2024-11-20T14:00:00Z"
    },
    // ... Ø³Ø§ÛŒØ± Ø³ÙˆØ§Ø¨Ù‚
  ]
}
```

**ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:**
- ØªÙ…Ø§Ù… Ø³ÙˆØ§Ø¨Ù‚ Ø¯Ø± ÛŒÚ© Ù„ÛŒØ³Øª
- Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ§Ø±ÛŒØ® (Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ø§ÙˆÙ„)
- Ø®Ù„Ø§ØµÙ‡ Ø¢Ù…Ø§Ø±ÛŒ (summary)
- Ø¬Ù…Ø¹ Ú©Ù„ Ø§Ù…ØªÛŒØ§Ø²

---

### **2ï¸âƒ£ Ø§ÛŒØ¬Ø§Ø¯ Ø³Ø§Ø¨Ù‚Ù‡ Ø¬Ø¯ÛŒØ¯**

```http
POST /api/applications/{application_id}/research-records/create/
Authorization: Bearer {token}
Content-Type: application/json
```

**Request Body (Ù…Ø«Ø§Ù„ - Ù…Ù‚Ø§Ù„Ù‡):**
```json
{
  "type": "ARTICLE",
  "data": {
    "title_fa": "Ø¹Ù†ÙˆØ§Ù† ÙØ§Ø±Ø³ÛŒ Ù…Ù‚Ø§Ù„Ù‡",
    "title_en": "English Title",
    "article_type": "RESEARCH_INTERNATIONAL",
    "journal_name": "Nature",
    "doi": "10.1234/...",
    "publish_year": 2024,
    "status": "PUBLISHED",
    "authors": "Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡ 1ØŒ Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡ 2"
  }
}
```

**Request Body (Ù…Ø«Ø§Ù„ - Ø§Ø®ØªØ±Ø§Ø¹):**
```json
{
  "type": "PATENT",
  "data": {
    "title_fa": "Ø¹Ù†ÙˆØ§Ù† Ø§Ø®ØªØ±Ø§Ø¹",
    "patent_number": "123456",
    "registration_date": "1402/09/15",
    "inventors": "Ù…Ø®ØªØ±Ø¹ 1ØŒ Ù…Ø®ØªØ±Ø¹ 2",
    "description": "ØªÙˆØ¶ÛŒØ­Ø§Øª"
  }
}
```

**Ø§Ù†ÙˆØ§Ø¹ type:**
- `ARTICLE` - Ù…Ù‚Ø§Ù„Ù‡
- `PATENT` - Ø§Ø®ØªØ±Ø§Ø¹
- `FESTIVAL_AWARD` - Ø¬Ø§ÛŒØ²Ù‡ Ø¬Ø´Ù†ÙˆØ§Ø±Ù‡
- `CONFERENCE` - Ù…Ù‚Ø§Ù„Ù‡ Ú©Ù†ÙØ±Ø§Ù†Ø³
- `BOOK` - Ú©ØªØ§Ø¨
- `MASTERS_THESIS` - Ù¾Ø§ÛŒØ§Ù†â€ŒÙ†Ø§Ù…Ù‡ Ø§Ø±Ø´Ø¯

**Response:**
```json
{
  "message": "Ø³Ø§Ø¨Ù‚Ù‡ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯",
  "record_id": 15,
  "type": "ARTICLE"
}
```

---

### **3ï¸âƒ£ ÙˆÛŒØ±Ø§ÛŒØ´ Ø³Ø§Ø¨Ù‚Ù‡**

```http
PUT /api/applications/{application_id}/research-records/{record_type}/{record_id}/
Authorization: Bearer {token}
```

**Ù…Ø«Ø§Ù„:**
```http
PUT /api/applications/123/research-records/article/5/
```

**Request Body:**
```json
{
  "title_fa": "Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÛŒØ¯",
  "journal_name": "Science"
}
```

---

### **4ï¸âƒ£ Ø­Ø°Ù Ø³Ø§Ø¨Ù‚Ù‡**

```http
DELETE /api/applications/{application_id}/research-records/{record_type}/{record_id}/
```

**Ù…Ø«Ø§Ù„:**
```http
DELETE /api/applications/123/research-records/patent/3/
```

---

### **5ï¸âƒ£ Ø®Ù„Ø§ØµÙ‡ Ø¢Ù…Ø§Ø±ÛŒ**

```http
GET /api/applications/{application_id}/research-records/summary/
```

**Response:**
```json
{
  "total_score": 35.5,
  "max_possible_score": 58,
  "completion_percentage": 61.2,
  "breakdown": {
    "articles_score": 20,
    "patents_score": 8,
    "awards_score": 5,
    "conferences_score": 1.5,
    "books_score": 1,
    "thesis_score": 0
  },
  "max_limits": {
    "articles": 40,
    "promotional_articles": 6,
    "conferences": 4,
    "books": 4,
    "thesis": 4
  }
}
```

---

## ğŸ”§ **Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø± Frontend:**

### **React/Vue Example:**

```javascript
// Ø¯Ø±ÛŒØ§ÙØª ØªÙ…Ø§Ù… Ø³ÙˆØ§Ø¨Ù‚
const fetchResearchRecords = async (applicationId) => {
  const response = await axios.get(
    `/api/applications/${applicationId}/research-records/`
  );
  
  return response.data; // { total_records, summary, records }
};

// Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ø­Ø¯
<Table>
  <thead>
    <tr>
      <th>Ù†ÙˆØ¹</th>
      <th>Ø¹Ù†ÙˆØ§Ù†</th>
      <th>Ø§Ù…ØªÛŒØ§Ø²</th>
      <th>ØªØ§Ø±ÛŒØ®</th>
      <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
    </tr>
  </thead>
  <tbody>
    {records.map(record => (
      <tr key={`${record.type}-${record.id}`}>
        <td>{getTypeLabel(record.type)}</td>
        <td>{record.title_fa}</td>
        <td>{record.score}</td>
        <td>{formatDate(record.created_at)}</td>
        <td>
          <button onClick={() => editRecord(record)}>ÙˆÛŒØ±Ø§ÛŒØ´</button>
          <button onClick={() => deleteRecord(record.type, record.id)}>Ø­Ø°Ù</button>
        </td>
      </tr>
    ))}
  </tbody>
</Table>

// Ø¢Ù…Ø§Ø±
<div className="summary">
  <h3>Ø®Ù„Ø§ØµÙ‡ Ø³ÙˆØ§Ø¨Ù‚ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ</h3>
  <p>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„: {data.total_records}</p>
  <p>Ø¬Ù…Ø¹ Ø§Ù…ØªÛŒØ§Ø²: {data.total_score}</p>
  <ul>
    <li>Ù…Ù‚Ø§Ù„Ø§Øª: {data.summary.articles}</li>
    <li>Ø§Ø®ØªØ±Ø§Ø¹Ø§Øª: {data.summary.patents}</li>
    <li>Ø¬ÙˆØ§ÛŒØ²: {data.summary.awards}</li>
    <li>Ú©Ù†ÙØ±Ø§Ù†Ø³: {data.summary.conferences}</li>
    <li>Ú©ØªØ§Ø¨: {data.summary.books}</li>
  </ul>
</div>
```

---

## ğŸ“š **Serializer Ù‡Ø§ÛŒ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ MA Ùˆ PhD:**

### **Ù…Ø´Ú©Ù„ Ù‚Ø¨Ù„ÛŒ:**
Ù…Ø¯Ù„ `ApplicationEducationRecord` Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø´Ø¯ Ùˆ Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ø¯Ú©ØªØ±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´Ø¯ØŒ Ø§Ù…Ø§ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„ÙÛŒ Ø¯Ø§Ø´Øª:
- ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø±Ø´Ø¯: `total_units_passed`, `semester_count`, `rank_status`
- ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¯Ú©ØªØ±ÛŒ: Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø³Ø§Ø¯Ù‡

### **Ø±Ø§Ù‡â€ŒØ­Ù„:**

```python
class MAEducationRecordSerializer:
    """ÙÙ‚Ø· ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø´Ø¯"""
    fields = [
        'degree_level', 'university', 'field_of_study', 'gpa',
        'total_units_passed',  # ÙˆÛŒÚ˜Ù‡ Ø§Ø±Ø´Ø¯
        'semester_count',      # ÙˆÛŒÚ˜Ù‡ Ø§Ø±Ø´Ø¯
        'class_size',          # ÙˆÛŒÚ˜Ù‡ Ø§Ø±Ø´Ø¯
        'rank_status',         # ÙˆÛŒÚ˜Ù‡ Ø§Ø±Ø´Ø¯
    ]

class PhDEducationRecordSerializer:
    """ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ú©ØªØ±ÛŒ"""
    fields = [
        'degree_level', 'university', 'field_of_study', 'gpa',
        'start_month', 'start_year',
        'graduation_month', 'graduation_year',
    ]

class ApplicationEducationRecordSerializer:
    """Serializer Ù¾ÙˆÛŒØ§ Ú©Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯"""
    def to_representation(self, instance):
        if instance.application.round.type == 'MA':
            return MAEducationRecordSerializer(instance).data
        else:
            return PhDEducationRecordSerializer(instance).data
```

**Ù…Ø²Ø§ÛŒØ§:**
- Ú©Ø§Ø±Ø¨Ø± Ø§Ø±Ø´Ø¯ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù†Ù…ÛŒâ€ŒØ¨ÛŒÙ†Ø¯
- Ú©Ø§Ø±Ø¨Ø± Ø¯Ú©ØªØ±ÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ ØºÛŒØ±Ø¶Ø±ÙˆØ±ÛŒ Ù†Ù…ÛŒâ€ŒØ¨ÛŒÙ†Ø¯
- API ØªÙ…ÛŒØ²ØªØ± Ùˆ Ø³Ø§Ø¯Ù‡ØªØ±
- Validation Ø¨Ù‡ØªØ±

---

## âœ… **Ø®Ù„Ø§ØµÙ‡ ØªØºÛŒÛŒØ±Ø§Øª:**

### **ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯:**
1. `apps/api/research_serializers.py`
   - `UnifiedResearchRecordSerializer`
   - `ResearchRecordCreateSerializer`

2. `apps/api/research_views.py`
   - `get_research_records()` - Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù…Ù‡
   - `create_research_record()` - Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÛŒØ¯
   - `manage_research_record()` - ÙˆÛŒØ±Ø§ÛŒØ´/Ø­Ø°Ù
   - `get_research_summary()` - Ø®Ù„Ø§ØµÙ‡ Ø¢Ù…Ø§Ø±ÛŒ

3. `apps/api/research_urls.py`
   - URL patterns Ø¨Ø±Ø§ÛŒ API

### **ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯Ù‡:**
4. `apps/api/applications_serializers.py`
   - `MAEducationRecordSerializer` (Ø¬Ø¯ÛŒØ¯)
   - `PhDEducationRecordSerializer` (Ø¬Ø¯ÛŒØ¯)
   - `ApplicationEducationRecordSerializer` (Ø¨Ø§Ø²Ù†ÙˆÛŒØ³ÛŒ Ø¨Ø§ to_representation)

5. `config/urls.py`
   - Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† `research_urls`

---

## ğŸ¯ **Ù†ØªÛŒØ¬Ù‡:**

### **Ù‚Ø¨Ù„:**
- âŒ 6 Ù…Ø¯Ù„ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡
- âŒ 6 API Endpoint Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡
- âŒ Ú©Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ Ø¯Ø± Frontend
- âŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ø®Øª Ø¯Ø± Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ø­Ø¯

### **Ø¨Ø¹Ø¯:**
- âœ… ÛŒÚ© API ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡
- âœ… ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª = ØªÙ…Ø§Ù… Ø³ÙˆØ§Ø¨Ù‚
- âœ… ÙØ±Ù…Øª Ù…Ø´ØªØ±Ú© Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´
- âœ… Ø¢Ù…Ø§Ø± Ø®ÙˆØ¯Ú©Ø§Ø±
- âœ… Serializer Ù‡Ø§ÛŒ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ MA/PhD
- âœ… Backend ØªÙÚ©ÛŒÚ©â€ŒØ´Ø¯Ù‡ (Ù†Ø±Ù…Ø§Ù„)
- âœ… Frontend ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ (Ø³Ø§Ø¯Ù‡)

---

**ğŸš€ Ø³ÛŒØ³ØªÙ… Ø­Ø±ÙÙ‡â€ŒØ§ÛŒØŒ Ù‚Ø§Ø¨Ù„ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ù¾Ø³Ù†Ø¯!**
